<!DOCTYPE html>
{% load static %}
<html lang="en">
<head>
    <title>Files - Prototype Editor</title>
    <link rel="shortcut icon" href="{%  static 'favicon.ico' %}" />
    <link rel="stylesheet" href="https://unpkg.com/blaze@4.0.0-6/scss/dist/blaze.min.css" />
    <link rel="stylesheet" href="{% static "css/editor.css" %}" />

    <script src="{% static "jquery/jquery-3.3.1.min.js" %}" type="text/javascript" charset="utf-8"></script>
    <script type="text/javascript">
        $(document).ready(() => {
            if (!"{{ err_msg }}") {
                $("#repo_error_label").hide()
            }
        });
    </script>
</head>
<body>

    <ul class="c-nav c-nav--inline">
        <li class="c-nav__item">Prototype Editor</li>
        <a href="{% url 'files' %}"><li class="c-nav__item">Files</li></a>
        <a href="{% url 'profile' %}"><li class="c-nav__item">Profile</li></a>
        <a href="{% url 'logout' %}"><li class="c-nav__item c-nav__item--right">Logout</li></a>
        {% if user.is_authenticated %}
                <a><li class="c-nav__item c-nav__item--right">Welcome, {{ user.username }}</li></a>
            {% else %}
                <a href="{% url 'login' %}"><li class="c-nav__item c-nav__item--right">Login/Register</li></a>
        {% endif %}
    </ul>

    <div id="body_login">
        <h1>Your repositories</h1>
        {% if repos %}
            <p>Select a repository to start coding.</p>
            <ul>
                {% for repo in repos %}
                    <li><a class="c-link" href="{% url 'e' user.username repo.name %}">{{ repo.name }}</a></li>
                {% endfor %}
            </ul>
        {% else %}
            <p>There's nothing here! Create a repository to get started.</p>
        {% endif %}

        <h1>Create a repository</h1>
        <p>Repositories help you keep your files organized and collected. You can create a new repository for each project,
           or however else you see fit to organize your code.
           Share your repository with other users to allow them to edit the files they contain as well.</p>
        <form method="post" action={% url 'files' %}>
            {% csrf_token %}
            <div class="c-input-group">
                <div class="o-field">
                    <input class="c-field" name="repo_name" type="text" placeholder="Repository name" />
                </div>
                <input class="c-button c-button--success" type="submit" value="Create repository" />
            </div>
        </form>
        <div class="c-alert c-alert--error" style="margin-top: 20px" id="repo_error_label">
            {{ err_msg }}
        </div>

        <h1>Repositories shared with you</h1>
        {% if shared_repos %}
            <ul>
                {% for shared_repo in shared_repos %}
                    <li><a class="c-link" href={% url 'e' shared_repo.user.username shared_repo.name %}>{{ shared_repo.name }}</a></li>
                {% endfor %}
            </ul>
        {% else %}
            <p>Repositories that other users have shared with you will appear here.</p>
        {% endif %}
    </div>

    <script type="text/javascript">
        // using jQuery
        csrftoken = jQuery("[name=csrfmiddlewaretoken]").val();
    </script>
</body>
</html>